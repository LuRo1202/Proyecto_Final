<!DOCTYPE html>
<html lang="es">
<head> 
    <meta charset="UTF-8">
    <title>ANEXO F - SOLICITUD REGISTRO/AUTORIZACIÓN</title>
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }

        body {
            font-family: Arial, sans-serif;
            font-size: 10pt;
            margin: 0;
            padding: 0;
        }

        .page {
            width: 100%;
            border-collapse: collapse;
        }

        .page td {
            padding: 3px 5px;
            vertical-align: top;
            height: 20px;
        }

        .border-all {
            border: 1px solid black;
        }

        .border-bottom {
            border-bottom: 1px solid black;
        }

        .border-right {
            border-right: 1px solid black;
        }

        .text-center {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        .section-title {
            font-weight: bold;
            font-size: 12pt;
            padding-top: 10px;
        }

        .checkbox {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 1px solid black;
            position: relative;
            margin: 0 2px;
        }

        .checkbox.checked:after {
            content: "X";
            position: absolute;
            top: -3px;
            left: 2px;
            font-size: 12px;
        }

        .no-print {
            display: none;
        }

        .signature-line {
            border-top: 1px solid black;
            width: 60%;
            margin: 25px auto 5px;
        }

        /* Estilos específicos para la tabla de formulario */
        .page td {
            padding: 5px;
        }

        .title-row {
            background-color: #f2f2f2;
            font-weight: bold;
            text-align: center;
        }

        .header-row {
            text-align: center;
            font-size: 12px;
            font-weight: bold;
        }

        .content-row {
            text-align: left;
            font-size: 11px;
        }

        .sub-content-row {
            font-size: 10px;
            text-align: left;
        }

    </style>
</head>
<body>
    <div class="no-print" style="text-align: center; padding: 10px;">
        <button onclick="window.print()" style="padding: 5px 15px; margin: 5px;">Imprimir</button>
        <button onclick="window.close()" style="padding: 5px 15px; margin: 5px;">Cerrar</button>
    </div>

    <table class="page" cellspacing="0" cellpadding="0">
        <!-- Título -->
        <tr>
            <td colspan="30" class="text-center section-title">ANEXO F "SOLICITUD - REGISTRO/AUTORIZACIÓN"</td>
        </tr>

        <!-- Sección I -->
        <tr class="title-row">
            <td colspan="30" class="section-title">I. DATOS DEL PRESTADOR E INSTITUCIÓN EDUCATIVA</td>
        </tr>

        <!-- Fila 1: Fecha y Nombre -->
        <tr>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">1.- Fecha:</td>
            <td colspan="5" class="border-bottom" id="fecha_solicitud"></td>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">2.- Nombre:</td>
            <td colspan="15" class="border-bottom" id="nombre_completo"></td>
        </tr>

        <!-- Fila 2: Apellidos y Nombres -->
        <tr>
            <td colspan="7"></td>
            <td colspan="7" class="text-center border-all">Apellido Paterno</td>
            <td colspan="7" class="text-center border-all">Apellido Materno</td>
            <td colspan="7" class="text-center border-all">Nombre(s)</td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td colspan="7"></td>
            <td colspan="7" class="border-all text-center" id="apellido_paterno"></td>
            <td colspan="7" class="border-all text-center" id="apellido_materno"></td>
            <td colspan="7" class="border-all text-center" id="nombre"></td>
            <td colspan="2"></td>
        </tr>

        <!-- Fila 3: Domicilio -->
        <tr>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">3.- Domicilio:</td>
            <td colspan="25" class="border-bottom" id="domicilio"></td>
        </tr>

        <!-- Fila 4: Teléfonos -->
        <tr>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">4.- Telefono Fijo:</td>
            <td colspan="5" class="border-bottom" id="telefono_fijo"></td>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">Telefono Celular:</td>
            <td colspan="5" class="border-bottom" id="telefono_celular"></td>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">EDAD:</td>
            <td colspan="3" class="border-bottom" id="edad"></td>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">SEXO:</td>
            <td colspan="3" class="border-bottom" id="sexo"></td>
        </tr>

        <!-- Fila 5: Correo y Carrera -->
        <tr>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">5.- Correo Electrónico:</td>
            <td colspan="12" class="border-bottom" id="correo"></td>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">6.- Carrera:</td>
            <td colspan="8" class="border-bottom" id="carrera"></td>
        </tr>

        <!-- Fila 6: Créditos y Promedio -->
        <tr>
            <td colspan="2"></td>
            <td colspan="8" class="content-row">7.- Porcentaje de créditos cubiertos a la fecha:</td>
            <td colspan="4" class="border-bottom" id="porcentaje_creditos"></td>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">Promedio:</td>
            <td colspan="4" class="border-bottom" id="promedio"></td>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">8.- Facebook:</td>
            <td colspan="4" class="border-bottom" id="facebook"></td>
        </tr>

        <!-- Fila 7: Matrícula y CURP -->
        <tr>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">9.- Matrícula:</td>
            <td colspan="5" class="border-bottom" id="matricula"></td>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">10.- CURP:</td>
            <td colspan="15" class="border-bottom" id="curp"></td>
        </tr>

        <!-- Sección II -->
        <tr class="title-row">
            <td colspan="30" class="section-title">II. DATOS DE LA ENTIDAD RECEPTORA</td>
        </tr>

        <!-- Fila 8: Entidad Receptora -->
        <tr>
            <td colspan="2"></td>
            <td colspan="6" class="content-row">5.- Nombre de la Entidad Receptora:</td>
            <td colspan="22" class="border-bottom" id="entidad_nombre"></td>
        </tr>

        <!-- Fila 9: Tipo de Entidad -->
        <tr>
            <td colspan="8"></td>
            <td colspan="3" class="text-center border-all">Federal</td>
            <td colspan="1"></td>
            <td colspan="3" class="text-center border-all">Estatal</td>
            <td colspan="1"></td>
            <td colspan="3" class="text-center border-all">Municipal</td>
            <td colspan="1"></td>
            <td colspan="3" class="text-center border-all">O N G</td>
            <td colspan="1"></td>
            <td colspan="3" class="text-center border-all">I.E.</td>
            <td colspan="1"></td>
            <td colspan="3" class="text-center border-all">I.P.</td>
        </tr>

        <!-- Marcar tipo de entidad seleccionado -->
        <tr>
            <td colspan="8"></td>
            <td colspan="3" class="text-center">
                <span id="tipo_federal" class="checkbox"></span>
            </td>
            <td colspan="1"></td>
            <td colspan="3" class="text-center">
                <span id="tipo_estatal" class="checkbox"></span>
            </td>
            <td colspan="1"></td>
            <td colspan="3" class="text-center">
                <span id="tipo_municipal" class="checkbox"></span>
            </td>
            <td colspan="1"></td>
            <td colspan="3" class="text-center">
                <span id="tipo_ong" class="checkbox"></span>
            </td>
            <td colspan="1"></td>
            <td colspan="3" class="text-center">
                <span id="tipo_ie" class="checkbox"></span>
            </td>
            <td colspan="1"></td>
            <td colspan="3" class="text-center">
                <span id="tipo_ip" class="checkbox"></span>
            </td>
        </tr>

        <tr>
            <td colspan="2"></td>
            <td colspan="6" class="content-row">6.- Unidad Administrativa Responsable:</td>
            <td colspan="22" class="border-bottom" id="unidad_administrativa"></td>
        </tr>

        <tr>
            <td colspan="2"></td>
            <td colspan="6" class="content-row">7.- Domicilio de la Unidad Administrativa Responsable:</td>
            <td colspan="22" class="border-bottom" id="entidad_domicilio"></td>
        </tr>

        <tr>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">8.- Municipio:</td>
            <td colspan="7" class="border-bottom" id="entidad_municipio"></td>
            <td colspan="2"></td>
            <td colspan="3" class="content-row">Teléfono:</td>
            <td colspan="7" class="border-bottom" id="entidad_telefono"></td>
            <td colspan="6"></td>
        </tr>

        <tr>
            <td colspan="2"></td>
            <td colspan="6" class="content-row">9.- Funcionario responsable del programa y cargo:</td>
            <td colspan="10" class="border-bottom" id="funcionario_responsable"></td>
            <td colspan="10" class="border-bottom" id="cargo_funcionario"></td>
            <td colspan="2"></td>
        </tr>

        <tr>
            <td colspan="2"></td>
            <td colspan="6" class="content-row">10.- Programa en el que participará el prestador:</td>
            <td colspan="22" class="border-bottom" id="programa_nombre"></td>
        </tr>

        <tr>
            <td colspan="2"></td>
            <td colspan="6" class="content-row">11.- Actividades que desarrollará el prestador:</td>
            <td colspan="22" class="border-bottom" id="actividades" style="height: 60px;"></td>
        </tr>

        <tr>
            <td colspan="2"></td>
            <td colspan="6" class="content-row">En que horario:</td>
            <td colspan="7" class="text-center">Lunes a Viernes</td>
            <td colspan="7" class="text-center">Lunes a Viernes</td>
            <td colspan="7" class="text-center">Sábado, Domingo, Días Festivos</td>
            <td colspan="1"></td>
        </tr>

        <tr>
            <td colspan="8"></td>
            <td colspan="2">de</td>
            <td colspan="3" class="border-bottom" id="horario_lv_inicio"></td>
            <td colspan="2">a</td>
            <td colspan="3" class="border-bottom" id="horario_lv_fin"></td>
            <td colspan="2">de</td>
            <td colspan="3" class="border-bottom"></td>
            <td colspan="2">a</td>
            <td colspan="3" class="border-bottom"></td>
            <td colspan="1"></td>
        </tr>

        <tr>
            <td colspan="2"></td>
            <td colspan="6" class="content-row">12.- Período de Prestación:</td>
            <td colspan="3">del:</td>
            <td colspan="2" class="border-bottom text-center" id="periodo_inicio_dia"></td>
            <td colspan="1"></td>
            <td colspan="2" class="border-bottom text-center" id="periodo_inicio_mes"></td>
            <td colspan="1"></td>
            <td colspan="2" class="border-bottom text-center" id="periodo_inicio_anio"></td>
            <td colspan="3">al:</td>
            <td colspan="2" class="border-bottom text-center" id="periodo_fin_dia"></td>
            <td colspan="1"></td>
            <td colspan="2" class="border-bottom text-center" id="periodo_fin_mes"></td>
            <td colspan="1"></td>
            <td colspan="2" class="border-bottom text-center" id="periodo_fin_anio"></td>
            <td colspan="1"></td>
        </tr>

        <tr>
            <td colspan="2"></td>
            <td colspan="6" class="content-row">13.- Horas de duración del programa o proyecto:</td>
            <td colspan="4">480 horas:</td>
            <td colspan="1"><span id="horas_480" class="checkbox checked"></span></td>
            <td colspan="3">Otras:</td>
            <td colspan="8" class="border-bottom"></td>
            <td colspan="6"></td>
        </tr>

        <tr>
            <td colspan="14" class="text-center" style="padding-top: 30px;">
                <div>Entidad Receptora</div>
                <div>Nombre y firma</div>
                <div class="signature-line"></div>
                <div>de la empresa, organización ó institución educativa</div>
            </td>
            <td colspan="2"></td>
            <td colspan="14" class="text-center" style="padding-top: 30px;">
                <div>Nombre y Firma el Prestador</div>
                <div class="signature-line"></div>
            </td>
        </tr>
    </table>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Obtener ID de la URL
            const urlParams = new URLSearchParams(window.location.search);
            const solicitudId = urlParams.get('id');

            if (solicitudId) {
                fetch(`../php/estudiantephp/gestionar_solicitud.php?id=${solicitudId}`)
                    .then(response => response.json())
                    .then(data => {
                        // Formatear fecha
                        const formatDate = (dateStr) => {
                            if (!dateStr) return '';
                            const date = new Date(dateStr);
                            const day = date.getDate().toString().padStart(2, '0');
                            const month = (date.getMonth() + 1).toString().padStart(2, '0');
                            const year = date.getFullYear();
                            return `${day}/${month}/${year}`;
                        };

                        // Formatear hora
                        const formatTime = (timeStr) => {
                            if (!timeStr) return '';
                            return timeStr.substring(0, 5);
                        };

                        // Separar fecha en día, mes y año
                        const splitDate = (dateStr) => {
                            if (!dateStr) return { day: '', month: '', year: '' };
                            const date = new Date(dateStr);
                            return {
                                day: date.getDate().toString(),
                                month: (date.getMonth() + 1).toString(),
                                year: date.getFullYear().toString().substring(2)
                            };
                        };

                        // Datos personales
                        document.getElementById('fecha_solicitud').textContent = formatDate(data.fecha_solicitud);
                        document.getElementById('nombre_completo').textContent = `${data.nombre} ${data.apellido_paterno} ${data.apellido_materno}`;
                        document.getElementById('apellido_paterno').textContent = data.apellido_paterno;
                        document.getElementById('apellido_materno').textContent = data.apellido_materno;
                        document.getElementById('nombre').textContent = data.nombre;
                        document.getElementById('domicilio').textContent = data.domicilio;
                        document.getElementById('telefono_fijo').textContent = data.telefono;
                        document.getElementById('telefono_celular').textContent = data.telefono;
                        document.getElementById('correo').textContent = data.correo;
                        document.getElementById('edad').textContent = data.edad;
                        document.getElementById('sexo').textContent = data.sexo;
                        document.getElementById('carrera').textContent = data.carrera;
                        document.getElementById('porcentaje_creditos').textContent = data.porcentaje_creditos;
                        document.getElementById('promedio').textContent = data.promedio;
                        document.getElementById('facebook').textContent = data.facebook || '';
                        document.getElementById('matricula').textContent = data.matricula;
                        document.getElementById('curp').textContent = data.curp;

                        // Datos de la entidad
                        document.getElementById('entidad_nombre').textContent = data.entidad_nombre;
                        
                        // Marcar tipo de entidad
                        const tipoEntidad = data.tipo_entidad;
                        if (tipoEntidad === 'Federal') document.getElementById('tipo_federal').classList.add('checked');
                        if (tipoEntidad === 'Estatal') document.getElementById('tipo_estatal').classList.add('checked');
                        if (tipoEntidad === 'Municipal') document.getElementById('tipo_municipal').classList.add('checked');
                        if (tipoEntidad === 'O.N.G.') document.getElementById('tipo_ong').classList.add('checked');
                        if (tipoEntidad === 'I.E.') document.getElementById('tipo_ie').classList.add('checked');
                        if (tipoEntidad === 'I.P.') document.getElementById('tipo_ip').classList.add('checked');
                        
                        document.getElementById('unidad_administrativa').textContent = data.unidad_administrativa;
                        document.getElementById('entidad_domicilio').textContent = data.entidad_domicilio;
                        document.getElementById('entidad_municipio').textContent = data.entidad_municipio;
                        document.getElementById('entidad_telefono').textContent = data.entidad_telefono;
                        document.getElementById('funcionario_responsable').textContent = data.funcionario_responsable;
                        document.getElementById('cargo_funcionario').textContent = data.cargo_funcionario;
                        document.getElementById('programa_nombre').textContent = data.programa_nombre;
                        document.getElementById('actividades').textContent = data.actividades;

                        // Horarios
                        document.getElementById('horario_lv_inicio').textContent = formatTime(data.horario_lv_inicio);
                        document.getElementById('horario_lv_fin').textContent = formatTime(data.horario_lv_fin);

                        // Período
                        const inicio = splitDate(data.periodo_inicio);
                        const fin = splitDate(data.periodo_fin);
                        document.getElementById('periodo_inicio_dia').textContent = inicio.day;
                        document.getElementById('periodo_inicio_mes').textContent = inicio.month;
                        document.getElementById('periodo_inicio_anio').textContent = inicio.year;
                        document.getElementById('periodo_fin_dia').textContent = fin.day;
                        document.getElementById('periodo_fin_mes').textContent = fin.month;
                        document.getElementById('periodo_fin_anio').textContent = fin.year;
                    })
                    .catch(error => {
                        console.error('Error al cargar los datos:', error);
                        alert('Error al cargar los datos de la solicitud.');
                    });
            }
        });
    </script>
</body>
</html>
